= Jenkins X

automated CI/CD for cloud native apps on Kubernetes

tedwon <jwon@redhat.com>

//:icons: font
//:source-highlighter: prettify
//:source-highlighter: highlightjs
//:source-highlighter: coderay
//:coderay-css: style

ifndef::imagesdir[:imagesdir: images]
ifndef::sourcedir[:sourcedir: ../../main/java]

== Jenkins

image::jenkins.png[width="400"]


== Jenkins X

image::jenkinsx.png[width="400"]


== James Strachan

image::jstrachan.png[width="400"]


== James Strachan

[%step]
* Created by James Strachan
** https://github.com/jenkins-x/jx/graphs/contributors
** https://www.linkedin.com/in/jstrachan/
** https://en.wikipedia.org/wiki/James_Strachan_(programmer)
* Released March of this year
** https://twitter.com/jstrachan/status/975796722147438598
* Golang

== James Strachan

[%step]
* Developed similar project in Red Hat until 2017
* Fabric8 Microservices Platform
** http://fabric8.io/
*** https://fabric8.io/guide/fabric8DevOps.html


== Introduction

[%step]
* https://jenkins.io/projects/jenkins-x/
** JEP-400
*** https://github.com/jenkinsci/jep/tree/master/jep/400
* Automated CI and CD
* Applications, Environments and Promotion
* Pull Request Preview Environments
* Feedback on Issues and Pull Requests

== Personally to me Jenkins X is

[%step]
* I can be familiar with Kubernetes/OpenShift.
* help to rapidly create, deploy and manage cloud native applications on Kubernetes.
* best practices


== Personally to me Jenkins X is

[%step]
* Guided delivery workflows for cloud native applications on Kubernetes
* A single pane of glass to view and manage application delivery with promotion, deployment and auditing
* Built-in integrations with best-of-breed tools


== What does that give me?

[%step]
* Each dev team gets their own:
* Development Tools Environment
** Jenkins master
** Elastic pool of Kubernetes build pods(agents)
** Nexus + Chartmuseum + Monocular (helm application store)
* Staging Environment
* Production Environment


== How does Jenkins X help?

[%step]
* Automates the installation/upgrade of tools
** Helm, Skaffold, Kaniko, Jenkins, KSync, Monocular, Nexus etc
** All configured + optimised for Kubernetes OOTB
* Automates CI/CD for your applications on Kubernetes
** Docker images
** Helm charts
** Pipelines


== How does Jenkins X help?

[%step]
* Uses GitOps to manage promotion between environments
** Test -> Staging -> Production
* Lots of feedback
** E.g. commenting on issues as they hit Staging + Production


== Environments in Kubernetes

image::env.png[]


== Cloud Providers

----
$ jx help create cluster

    * aks (Azure Container Service - https://docs.microsoft.com/en-us/azure/aks)
    * aws (Amazon Web Services via kops - https://github.com/aws-samples/aws-workshop-for-kubernetes/blob/master/readme.adoc)
    * eks (Amazon Web Services Elastic Container Service for Kubernetes - https://docs.aws.amazon.com/eks/latest/userguide/getting-started.html)
    * gke (Google Container Engine - https://cloud.google.com/kubernetes-engine)
    * iks (IBM Cloud Kubernetes Service - https://console.bluemix.net/docs/containers)
    * oke (Oracle Cloud Infrastructure Container Engine for Kubernetes - https://docs.cloud.oracle.com/iaas/Content/ContEng/Concepts/contengoverview.htm)
    * kubernetes for custom installations of Kubernetes
    * minikube (single-node Kubernetes cluster inside a VM on your laptop)
	* minishift (single-node OpenShift cluster inside a VM on your laptop)
	* openshift for installing on 3.9.x or later clusters of OpenShift
----

== Jenkins X, X means...

* Jenkins + other apps
* https://jenkins-x.io 


== Jenkins X, X means...

[%step]
* Jenkins
** CI/CD pipeline solution
* Nexus
** Artifact repository
* https://helm.sh
** package manager for Kubernetes
* Chartmuseum
** Helm Chart repository


[NOTE.speaker]
--
Helm is ...
Helm Chart is ...
--

== Jenkins X, X means...

[%step]
* Monocular
** Web UI for helm charts
* https://draft.sh
** build packs used to bootstrap applications so they build and run on Kubernetes
*** Helm is the most popular Kubernetes package manager used to install and upgrade your applications
* https://github.com/jenkins-x/jenkins-x-platform


== Jenkins X, X means...

[%step]

* Skaffold
** enabled RAD development, abstracts building and pushing images
* Anchore
** service that analyzes docker images and applies user-defined acceptance policies to allow automated container image validation and certification


== How do we setup Kubernetes + Jenkins X?

* Install the command line tool: jx
* http://jenkins-x.io/getting-started/install/

----
macOs:
brew tap jenkins-x/jx
brew install jx 

linux:
curl -L https://github.com/jenkins-x/jx/releases/download/v1.2.16/jx-linux-amd64.tar.gz | tar xzv 
sudo mv jx /usr/local/bin
----

== What are the challenges?

[%step]
* How to get started?
* How do I wire everything together?
* What do I need to start developing, building and deploying?
* How do I access my applications?
* How do dev teams work with Kubernetes?
* How do I migrate my applications to the cloud?



== Step Overview

[%step]
* Step 1.Install Jx
** https://jenkins-x.io/getting-started/install/ 
* Step 2. Create Cluster GKE
** https://jenkins-x.io/demos/create_cluster_gke/ 
* Step 3. Create Cloud App - Spring Boot
** http://jenkins-x.io/demos/create_spring/

== Step 2. Create Cluster GKE

----
asciinema rec -i 1 -t "Creating GKE Kubernetes cluster with Jenkins X"

jx create cluster gke --cluster-name myk8scluster1027 --username admin --default-admin-password admin123! --verbose=true --log-level debug

jx create cluster gke --cluster-name tedd824-k8s-cluster-1027 --username admin --default-admin-password admin123!

----
* https://asciinema.org/a/XGXT28lsJN2SNsuOAfb45Q6BM



== jx command

* jx context
* jx namespace
* jx env


== demo

* GKE cluster: realtimecep@gmail.com
** myk8scluster1020
*** https://goo.gl/PyrnCz
*** https://goo.gl/PRh9eo
**** Node: gke-myk8scluster1020-default-pool-1c9647a9-mmfk
**** Context: gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020


== demo

* GKE cluster: tedd824@gmail.com

== demo

[source,bash,options="nowrap"]
----
# Set which Kubernetes cluster kubectl communicates
kubectl config use-context gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020
Switched to context "gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020".

jx context gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020
Using namespace 'kube-system' from context named 'gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020' on server 'https://35.187.213.144'.

# view the current context
jx ctx -b
Using namespace 'kube-system' from context named 'gke_my-k8s-project-220013_asia-northeast1-a_myk8scluster1020' on server 'https://35.187.213.144'.

jx ns
jx ns jx
kubectl get pods --all-namespaces             # List all pods in all namespaces
kubectl get pods -o wide                      # List all pods in the namespace, with more details
kubectl get services
----

== How do I create applications?

[%step]
* Available commands:
** jx create spring
** jx create quickstart
** jx import


== How do I create applications?

[%step]
* Automatically set up CI/CD pipelines for new + imported projects
** Setups up git repository
** Registers webhooks to trigger pipelines for PR / master
** Triggers the first pipeline


== Please try it out!

* https://jenkins-x.io/


== References

* Roadmap https://jenkins-x.io/contribute/roadmap/
* https://www.dropbox.com/s/2l3yudybl8dx4j7/2.pdf?dl=0
* GitOps https://dzone.com/articles/what-is-gitops-really
* https://docs.google.com/presentation/d/1hwt2lFh3cCeFdP4xoT_stMPs0nh2xVZUtze6o79WfXc/edit#slide=id.p
* 2011년 메모: https://tedwon.atlassian.net/wiki/spaces/SE/pages/1212796/CloudBees